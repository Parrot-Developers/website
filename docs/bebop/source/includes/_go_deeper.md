# Go deeper

If you want to build your own SDK, you can ! It is fully open sourced.

The version control is based on the repo tool, you can get it following [these instructions](http://source.android.com/source/downloading.html#installing-repo).<br/>
Learn [here](https://source.android.com/source/using-repo.html) how to use repo.<br/>
On *Mac OS* you will need execute this command to install with brew some needed tools:<br/>
`
brew install bash coreutils gettext pkgconfig wget
`

## Download all sources

SDK [sources are hosted on github](https://github.com/Parrot-Developers/). To download them, you only have to init repo with the arsdk_manifests url:<br/>
`repo init -u https://github.com/Parrot-Developers/arsdk_manifests.git`

After that, you can download all the other repository automatically by executing the command:<br/>
`repo sync`

Then follow the [How to build the SDK section](#how-to-build-the-sdk).


## Organisation

SDK is organized as following:

### arsdk_manifests
This git repository list all other repositories that are part of or needed by the SDK.

### arsdk_products
This git repository provides a build.sh that you can call to build the whole SDK.

### ARSDKBuildUtils
This repo contains all the tools to create the autotools needed to build the SDK. It is called by build.sh file contained in arsdk_products.

### libARCommands
This library contains all the sources related to the commands you can sent to and receive from the drone.

### libARController
This library provides an abstraction level to connect to the drone. With this library you can create a device controller, which ables you to pilot, take pictures, receive stream (depending on the drone), and send/receive other commands from the drone.

### libARDataTransfer
This library helps you transfering data from or to the drone.

### libARDiscovery
This library helps you to discover from the network all supported drones. 

### libARMavlink
This library helps you to generate an automated flight file. 

### libARMedia
This library provides an abstraction layer around the medias generated by the drones.

### libARNetwork
This library is in charge of sending and receiving packets to/from the drone. 

### libARNetworkAL
This library provides an abstraction layer around the different networks (BLE or Wifi networks).

### libARSAL
This library provides a system abstraction layer.

### libARStream
This library deals with all streaming types. It packs/unpacks streams.

### libARStream2
This library deals with the new h264 stream. It packs/unpacks streams and deals with rtp streams.

### libARUpdater
This library helps you to update your drone. It provides functions to tests if the version is the last one and functions to update the drone.

### libARUtils
This library provides utilities classes.

### Samples
You can find in this repo some examples for iOS, Android and Unix.<br/>

##How to build the SDK

You should have first [downloaded all the sources of the SDK](#download_all_sources).

**The root folder where you have executed the *repo init* and *repo sync* command will be noted \<SDK\>**

###Required external tools

These external tools are required to build the SDK:

* **git**
* **build-essential** (only for Linux)
* **autoconf**
* **libtool**
* **libavahi-client-dev** 
* **libavcodec-dev**
* **libavformat-dev**
* **libswscale-dev**
* **libncurses5-dev**
* **mplayer**

**Linux**: install these tools using your favorite package manager <br/>
**OSX**: you will need XCode to be installed. Then, you can use [brew](http://brew.sh/) to install these tools.<br/>

###General Build

The build is done by the `./build.sh` script. You can run `./build.sh --help` to know more about the building options.<br/>
The general way to build is:<br/>
`./build.sh -p arsdk-VARIANT -t TASK OTHER_ARGS`

Variants available are:

- ios (for iphoneos on iOS)
- ios_sim (for iphone simulator on iOS)
- android (for Android)
- native (for Unix)

###Unix Build
**Linux**: Tested on Ubuntu 12.10, 13.04, 13.10 and 14.04<br/>
**OSX**: Tested on 10.10.5<br/>

The command to build the SDK for Unix platform is:<br/>
`./build.sh -p arsdk-native -t build-sdk -j`<br/>
The output will be in \<SDK\>/out/Unix-base/staging/usr/<br/>

Tasks available are:

- build-sdk (Build native sdk)
- build-sample (Build all native samples)
- build-sample-SAMPLE_NAME (Build unix sdk sample for SAMPLE_NAME)

**Running the samples:**

In order to run the samples, you must add the `<SDK>/out/arsdk-native/staging/usr/lib` folder to the `LD_LIBRARY_PATH` environment variable. This can be done by using the `<SDK>/out/Unix-base/staging/native-wrapper.sh` script.
This script can be used in the two following ways:

- As a shell script to call a single sample: `<SDK>/out/arsdk-native/staging/native-wrapper.sh <SDK>/out/arsdk-native/staging/usr/bin/<sample> [args...]`.
- As a sourced script to set the `PATH` and `LD_LIBRARY_PATH` environment variables: `source <SDK>/out/arsdk-native/staging/native-wrapper.sh`. After sourcing this script, you can directly call samples by their name without giving a full path, as the `<SDK>/out/arsdk-native/staging/usr/bin` folder will be added to your path.

###iOS Build
**OSX**: Tested on 10.9.2 and 10.10.3<br/>

The command to build the SDK for iOS is:<br/>
`./build.sh -p arsdk-ios -t build-sdk -j`<br/>
The output will be in \<SDK\>/out/arsdk-ios/staging/usr/<br/>

Tasks available are:

- build-sdk (Build ios sdk)
- build-sample (Build the ios samples in debug)

###iPhone Simulator Build
**OSX**: Tested on 10.9.2 and 10.10.3<br/>

The command to build the SDK for iOS is:<br/>
`./build.sh -p arsdk-ios_sim -t build-sdk -j`<br/>
The output will be in \<SDK\>/out/arsdk-ios_sim/staging/usr/<br/>

Tasks available are:

- build-sdk (Build ios sdk)
- build-sample (Build the ios samples in debug)

###Android Build
**Linux**: Tested on Ubuntu 12.10, 13.04, 13.10 and 14.04<br/>
**OSX**: Tested on 10.9.2 and 10.10.3<br/>

You will need this following parts: 

- a working jdk with java 6 (1.6) support
- Android SDK and NDK (The SDK is built
 against Android-19 and requires Android-14 runtime)
- declare environment variables named `ANDROID_SDK_PATH` and
 `ANDROID_NDK_PATH`, each pointing to the root of the corresponding dev kit

The command to build the SDK for Android platform is:<br/>
`./build.sh -p arsdk-android -t build-sdk -j`<br/>
The output will be in \<SDK\>/out/arsdk-android/*ARCH*/staging/usr/<br/>

Tasks available are:

- build-sdk (Build android sdk for all architectures)
- build-sdk-armeabi (Build android sdk for armeabi)
- build-sdk-armeabi_v7a (Build android sdk for armeabi_v7a)
- build-sdk-mips (Build android sdk for mips)
- build-sdk-x86 (Build android sdk for x86)
- build-jni (Build android sdk & jni)
- build-sample (Build the android sample in debug)

### Clean

To do a clean build, simply delete the \<SDK\>/out/ folder.
