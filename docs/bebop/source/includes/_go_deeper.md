# Go deeper

If you want to build your own SDK, you can ! It is fully open sourced.

The version control is based on the repo tool, you can get it following [these instructions](http://source.android.com/source/downloading.html#installing-repo).<br/>
Learn [here](https://source.android.com/source/using-repo.html) how to use repo.<br/>
On *Mac OS* you will need execute this command to install with brew some needed tools:<br/>
`
brew install bash coreutils gettext pkgconfig wget
`

## Download all sources

SDK [sources are hosted on github](https://github.com/Parrot-Developers/). To download them, you only have to init repo with the arsdk_manifests url:<br/>
`repo init -u https://github.com/Parrot-Developers/arsdk_manifests.git`

After that, you can download all the other repository automatically by executing the command:<br/>
`repo sync`

Then follow the [How to build the SDK section](#how-to-build-the-sdk).


## Organisation

SDK is organized as following:

### arsdk_manifests
This git repository list all other repositories that are part of or needed by the SDK.

### arsdk_products
This git repository provides a build.sh that you can call to build the whole SDK.

### ARSDKBuildUtils
This repo contains all the tools to create the autotools needed to build the SDK. It is called by build.sh file contained in arsdk_products.

### libARCommands
This library contains all the sources related to the commands you can sent to and receive from the drone.

### libARController
This library provides an abstraction level to connect to the drone. With this library you can create a device controller, which ables you to pilot, take pictures, receive stream (depending on the drone), and send/receive other commands from the drone.

### libARDataTransfer
This library helps you transfering data from or to the drone.

### libARDiscovery
This library helps you to discover from the network all supported drones. 

### libARMavlink
This library helps you to generate an automated flight file. 

### libARMedia
This library provides an abstraction layer around the medias generated by the drones.

### libARNetwork
This library is in charge of sending and receiving packets to/from the drone. 

### libARNetworkAL
This library provides an abstraction layer around the different networks (BLE or Wifi networks).

### libARSAL
This library provides a system abstraction layer.

### libARStream
This library deals with all streaming types. It packs/unpacks streams.

### libARStream2
This library deals with the new h264 stream. It packs/unpacks streams and deals with rtp streams.

### libARUpdater
This library helps you to update your drone. It provides functions to tests if the version is the last one and functions to update the drone.

### libARUtils
This library provides utilities classes.

### Samples
You can find in this repo lots of basic examples.<br/>
For iOS, if you want to use the precompiled frameworks instead of building the whole SDK, you will have to to:

* click on the target
* choose Build Settings
* edit the value of *Framework Search Paths* by deleting ```$(SRCROOT)/../../../../ARSDKBuildUtils/Targets/iOS/Install/Frameworks```

##How to build the SDK

You should have first [downloaded all the sources of the SDK](#download_all_sources).

**The root folder where you have executed the *repo init* and *repo sync* command will be noted \<SDK\>**

###Required external tools

These external tools are required to build the SDK :

* **git**
* **wget**
* **automake**
* **autoconf**
* **libtool**
* **yasm**
* **nasm**

**Linux** : install these tools using your favorite package manager <br/>
**OSX** : you will need XCode to be installed. Then, you can use [brew](http://brew.sh/) to install these tools.<br/>

###General Build

The build is done by the `./build.sh` script. You can run `./build.sh --help` to know more about the building options.<br/>
The general way to build is:<br/>
`./build.sh -p PLATFORM-VARIANT -t TASK OTHER_ARGS`

Platforms available are:

- iOS
- Android
- Unix 

###Unix Build
**Linux** : Tested on Ubuntu 12.10, 13.04, 13.10 and 14.04<br/>
**OSX** : Tested on 10.10.5<br/>

The command to build the SDK for Unix platform is :<br/>
`./build.sh -p Unix-forall -t build-sdk -j`<br/>
The output will be in \<SDK\>/out/Unix-base/staging/usr/<br/>

Variants available are:

- base

Tasks available are:

- build-sdk

###iOS Build
**OSX** : Tested on 10.9.2 and 10.10.3<br/>

The command to build the SDK for iOS is :<br/>
`./build.sh -p iOS-forall -t build-sdk -j`<br/>
The output will be in \<SDK\>/out/iOS-*VARIANT*/staging/usr/<br/>

Variants available are:

- forall (build all variants)
- iphoneos
- iphonesimulator

Tasks available are:

- build-sdk (only build libraries)
- build-sample (build-sdk + execute xcodebuild in all samples)

###Android Build
**Linux** : Tested on Ubuntu 12.10, 13.04, 13.10 and 14.04<br/>
**OSX** : Tested on 10.9.2 and 10.10.3<br/>

For **OSX**, you will need to [install rpl in version 1.5.5 from sourceforge](http://sourceforge.net/projects/rpl/files/rpl/rpl-1.5.5/), and add it to your PATH.

You will need this following parts : 

- a working jdk with java 6 (1.6) support
- Android SDK and NDK (The SDK is built
 against Android-19 and requires Android-14 runtime)
- declare environment variables named `ANDROID_SDK_PATH` and
 `ANDROID_NDK_PATH`, each pointing to the root of the corresponding dev kit
- You must have the android native toolchains for android-14 in your path.
 To generate a standalone toolchain, use the following command :
`$ANDROID_NDK_PATH/build/tools/make-standalone-toolchain.sh --platform=android-14 --arch=<arch> --install-dir=<your/installation/dir>`.
 For the three archs `arm`, `mips` and `x86`
--> Note that you must use three different installation directories (one for
 each architecture), and you need to add each `install_dir/bin` directory to your
 path. A typical installation is to have an `~/android_toolchains/` folder, in
 which you will put the three `toolchain_<arch>` folders. This facilitates the
 updates as you can just remove the root folder and generate new toolchains when
 upgrading the android NDK.
 

The command to build the SDK for Android platform is :<br/>
`./build.sh -p Android-forall -t build-sdk -j`<br/>
The output will be in \<SDK\>/out/Android-*VARIANT*/staging/usr/<br/>

Variants available are:

- forall (build all variants)
- armeabi
- armeabi_v7a
- mips
- x86

Tasks available are:

- build-sdk (only build libraries)
- build-jni (build-sdk + execute ndk-build in all samples)
- build-sample (build-jni + execute gradlew assembledebug in all samples)

### Clean

To do a clean build, simply delete the \<SDK\>/out/ folder.
